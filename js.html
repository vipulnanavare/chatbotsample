<!DOCTYPE html>
<html>
<title>Web Page Design</title>
<head>
<script type = "text/javascript" 
         src = "https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js">
      </script>
<script>
var json_parsed_response;
//var settings = {
//		  "async": true,
//		  "crossDomain": true,
//		  "url": "https://api.dialogflow.com/v1/query?v=20150910&lang=en&query=Hi&sessionId=12345&timezone=Asia%2FCalcutta",
//		  "method": "GET",
//		  "headers": {
//		    "authorization": "Bearer 56c7b8cffe8c44f3a063d2d4abcbbde1",
//		    "cache-control": "no-cache",
//		    "postman-token": "3edc16ba-f738-c02f-298e-04f6cc452da9"
//		  }
//		}
//
//		$.ajax(settings).done(function (response) {
//		  console.log(response);
//		});

//var httpRequest = new XMLHttpRequest();
//httpRequest.open('GET', "https://api.dialogflow.com/v1/query?v=20150910&lang=en&query=Hi&sessionId=12345&timezone=Asia/Calcutta", true);
//httpRequest.setRequestHeader( 'Access-Control-Allow-Origin', '*');
//httpRequest.setRequestHeader('authorization', 'Bearer 56c7b8cffe8c44f3a063d2d4abcbbde1');
//httpRequest.onerror = function(XMLHttpRequest, textStatus, errorThrown) {
//  console.log( 'The data failed to load :(' );
//  console.log(JSON.stringify(XMLHttpRequest));
//};
//httpRequest.onload = function() {
// console.log('SUCCESS!');
//}

//var url = 'https://api.dialogflow.com/v1/query?v=20150910&lang=en&query=Hi&sessionId=12345&timezone=Asia%2FCalcutta';
//var xhr = createCORSRequest('GET', url);
//xhr.setRequestHeader(
//    'authorization', 'Bearer 56c7b8cffe8c44f3a063d2d4abcbbde1');
//xhr.send();

    // Create the XHR object.
            function createCORSRequest(method, url) {
                var xhr = new XMLHttpRequest();
				
                if ("withCredentials" in xhr) {
                    // XHR for Chrome/Firefox/Opera/Safari.
                    xhr.open(method, url, true);
					alert("Withcredentials");
					xhr.setRequestHeader('authorization', 'Bearer 56c7b8cffe8c44f3a063d2d4abcbbde1');
                } else if (typeof XDomainRequest != "undefined") {
                    // XDomainRequest for IE.
                    xhr = new XDomainRequest();
                    xhr.open(method, url);
					xhr.setRequestHeader('authorization', 'Bearer 56c7b8cffe8c44f3a063d2d4abcbbde1');
                } else {
                    // CORS not supported.
                    xhr = null;
                }
                return xhr;
            }


            // Make the actual CORS request.
            function makeCorsRequest() {
                // All HTML5 Rocks properties support CORS.
                var url = 'https://api.dialogflow.com/v1/query?v=20150910&lang=en&query=My_name_is_vipul&sessionId=12345&timezone=Asia%2FCalcutta';

                var xhr = createCORSRequest('get', url);
                if (!xhr) {
                    alert('CORS not supported');
                    return;
                }

                // Response handlers.
                xhr.onload = function () {
                    var text = xhr.responseText;
                //    console.log(text);
					var json_parsed = JSON.parse(text);
				//	console.log(json_parsed);
				//	console.log(json_parsed.result.fulfillment.speech);
					var response_final_output=json_parsed.result.fulfillment.speech;
					console.log(json_parsed.result.fulfillment.speech);
                    //alert('Response from CORS request to ' + url + ': ' );
                };

                xhr.onerror = function () {
                    //alert('Woops, there was an error making the request.');
                };

                xhr.send();
            }
            makeCorsRequest();
			





//console.log(response.queryResult.fulfillmentText);
</script>
</head>
<body>
</body>
</html>